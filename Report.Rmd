---
title: "Reproducible Research"
author: "Kelly Schumann"
date: "6/10/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## The data...

This report was generated by the Activity Monitoring data requested in the Project specifications. The consists of 3 fields  * steps  * date  * interval (each interval is a 5 second timeslot with the first starting at 12:00AM). NA in the steps variable exists and will be replaced with 0. There are 17568 observations within the dataset, starting on Oct 1, 2012 12:00AM, thru Nov 30, 2012 11:55PM.

The 9 items to be committed  
**1. The git repo link** and SHA-1  - [This repository](https://github.com/KellySchumann/Reproducible) and SHA-1 = 764c68241b147ba53206492c1293d008442e5682

**2. Histogram of the total number of steps taken each day.**
```{r}
library(dplyr)
library(lubridate)

dataset <- read.csv("activity.csv")
dataset$timing <- as.POSIXct(dataset$date) + minutes((floor(dataset$interval / 100) * 60) + (dataset$interval %% 100))

groupby <- group_by(dataset,date)
plotdata <- summarise(groupby,TotalSteps = sum(steps, na.rm=TRUE))
plotdata$date <- as.POSIXct(strptime(as.character(plotdata$date), "%Y-%m-%d"))

hist(plotdata$TotalSteps, xlab="Total Number of Steps", ylab="Number of days", main = "Histogram of Total step taken per day")

```

**3. Mean and median number of steps taken each day **
```{r}
library(ggplot2)
library(dplyr)
plotdata <- summarise(groupby,MeanSteps = mean(steps, na.rm=TRUE), MedianSteps = median(steps, na.rm=TRUE))
print(plotdata)
```

**4. Time series plot of the average number of steps taken... ** Note that the median is showing as zero as many more (11014) 5 minute intervals have 0 steps taken (sleeping, sitting,...) and 2304 NA's while only 4250 observations have at least one step.
```{r}
plot4 <- plotdata
plot4$date <- as.Date(plotdata$date)

#ggplot(data=plot4, aes(date, MeanSteps, group=1,na.rm=TRUE)) + geom_line(color="blue") + scale_x_date(breaks="weeks", date_labels = "%b-%d", date_minor_breaks = "days") + labs(x="Date in 2012", y="Average Steps", title="Average and Median Steps per day")



p <- ggplot(data=plot4, aes(date)) 
p <- p + geom_line(aes(y=MeanSteps, group=1), color="blue",na.rm=TRUE) 
p <- p + geom_line(aes(y=MedianSteps, group=1), color="red",na.rm=TRUE) 
p <- p + scale_x_date(breaks="weeks", date_labels = "%b-%d", date_minor_breaks = "days") 
p <- p + labs(x="Date in 2012", y="Average Steps", title="Average and Median Steps per day")
p


```

**5. The 5-minute interval that, on average, contains the maximum number of steps.** To find the maximum number of steps
```{r}

  nonz <- subset(dataset, ! is.na(dataset$steps))
  nonz[nonz$steps == max(nonz$steps, na.rm=TRUE),]

```
  resulting in Nov 27, 2012 at 6:15 a maximum of 806 steps were taken.

**6. Code to describe and show a strategy for imputing missing data.**  
This dataset seems to have a large number of of NA's for the number steps, this seems to be a case of a MAR situation. I will implement a missForest as this variable appears to group based in values of the subject is walking they will continue to walk and if non-walking like-wise. This seems to be a logical imputing function for this variable.
```{r}
library(mice)

imputed_Data <- mice(dataset, m=5, maxit = 50, method = "pmm", seed= 500)
completeDS <- complete(imputed_Data,2)


```

**7. Histogram of the total number of steps taken each day after missing values are imputed**  
```{r}
dataset <- completeDS
groupby <- group_by(dataset,date)
plotdata <- summarise(groupby,TotalSteps = sum(steps, na.rm=TRUE))
plotdata$date <- as.POSIXct(strptime(as.character(plotdata$date), "%Y-%m-%d"))

hist(plotdata$TotalSteps, xlab="Total Number of Steps", ylab="Number of days", main = "Histogram of Total step taken per day")

```

**8. Panel plot comparing the average number of steps taken per 5-minute interval across weekdays and weekends**  
```{r}
completeDS$dow <- wday(completeDS$timing)

completeDS$we = factor((completeDS$dow == 1) | (completeDS$dow == 7), labels = c("Weekday","Weekend"))

isSatSun <- group_by(completeDS, interval, we)
plot8 <- summarise(isSatSun,Ave = mean(steps, na.rm=TRUE))
names(plot8)[2] = "WeekEnd"

ggplot(data=plot8) + geom_line(aes(plot8$interval, plot8$Ave, color=WeekEnd)) + facet_wrap(~ WeekEnd)+ labs(x="Time of Day (2400 Time)", y = "Ave steps per interval", title="Steps per 5-minute interval across  Weekdays vs Weekends")

```

**9. All of the R code needed to reproduce the results (numbers, plots, etc.) in the report**  
   You have just looked at all of the code...

